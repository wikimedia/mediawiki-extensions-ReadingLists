@import 'mediawiki.skin.variables.less';
@min-width-card: 20rem; // equal to 320px.
@max-width-card: 28rem; // equal to 448px. Note: alternatively up to `1fr`.
@max-width-card--mobile: 34rem; // equal to 544px.

.client-js {
	.reading-lists__errorbox {
		display: none;
	}
}

.reading-lists-container {
	.reading-lists-heading {
		display: flex;
		align-items: flex-end;
		gap: @spacing-50;
	}

	.reading-lists-sort-text {
		font-size: @font-size-small;
		font-weight: @font-weight-normal;
		color: @color-subtle;
		margin-left: @spacing-50;
	}

	.reading-lists-toolbar {
		display: flex;
		gap: @spacing-50;
		margin-top: @spacing-50;
	}

	.cdx-menu__listbox,
	.cdx-menu__group {
		list-style-type: none;
		margin: 0;
		padding: 0;
	}

	.cdx-menu__group__item {
		margin-bottom: @spacing-12;
	}

	.cdx-progress-bar {
		width: @size-half;
		margin-top: @spacing-200;
		margin-left: auto;
		margin-right: auto;
	}
}

.reading-lists-grid {
	display: grid;
	grid-auto-rows: 1fr;
	// Auto-fit to fit as many columns as possible in the row.
	// Minimum width of a column is 22rem equal to 352px.
	// Only for browsers which do _not_ support `:has()` below.
	// Support: Chrome ≤ 105, Edge ≤ 105, Firefox ≤ 120, Safari ≤ 15.3
	grid-template-columns: repeat( auto-fit, minmax( @min-width-card, @max-width-card ) );
	// Align all items to the start of the row.
	justify-content: start;
	gap: @spacing-100;
	// Default: Limit to 4 items maximum per row.
	// Note: Desktop and Desktop wide gets 4 items per row as well.
	max-width: calc( 4 * @max-width-card + 3 * @spacing-100 );
	margin-top: @spacing-75;

	// Mobile: Limit to 1 item maximum per row, but with higher grid container max width.
	@media screen and ( max-width: @max-width-breakpoint-mobile ) {
		grid-template-columns: repeat( auto-fit, minmax( @min-width-card, @max-width-card--mobile ) );
		max-width: calc( 2 * @max-width-card--mobile + 1 * @spacing-100 );
	}

	// Tablet: Limit to 2 items maximum per row.
	// Note: As of current `@max-width-breakpoint-tablet` is 1119px.
	@media screen and ( max-width: @max-width-breakpoint-tablet ) {
		max-width: calc( 2 * @max-width-card--mobile + 1 * @spacing-100 );
	}

	// More modern browsers supporting `:has()`.
	// Default: All items, no matter which number, get equal space via `1fr`.
	// Support: Chrome ≥ 105, Edge ≥ 105, Safari ≥ 15.4 , Firefox ≥ 121
	&:has( * ) {
		grid-template-columns: repeat( auto-fit, minmax( @min-width-card, 1fr ) );
	}

	// Match container with only 1 item `:has( > :nth-child( 1 ) )` and not more.
	&:has( :nth-child( 1 ) ):not( :has( :nth-child( 2 ) ) ) {
		max-width: @max-width-card--mobile;
	}

	// Match container with only 2 items `:has( > :nth-child( 2 ) )` and not more.
	&:has( :nth-child( 2 ) ):not( :has( :nth-child( 3 ) ) ) {
		max-width: calc( 2 * @max-width-card--mobile + 1 * @spacing-100 );

		@media screen and ( max-width: @max-width-breakpoint-mobile ) {
			grid-template-columns: repeat( auto-fit, minmax( @min-width-card, @max-width-card--mobile ) );
		}
	}

	// Match container with 3 items and more.
	/* stylelint-disable-next-line no-descending-specificity */
	&:has( :nth-child( 3 ) ) {
		grid-template-columns: repeat( auto-fit, minmax( @min-width-card, 1fr ) );
	}

	.cdx-card {
		flex-direction: row;
		// Allow thumbnail and text container to stretch to the same height.
		align-items: stretch;
		min-width: @min-width-card;
		max-width: @max-width-card--mobile;
		// Use same minimum height as thumbnail to avoid non-thumbnail lists to jump in height.
		min-height: @size-800;
		// Set 0 padding to flush thumbnails and instead use padding on text container.
		padding: 0;
		overflow: hidden;

		// Mobile only: Max it out at `34rem` (544px), specifically important on landscape mode.
		@media screen and ( max-width: @max-width-breakpoint-mobile ) {
			max-width: @max-width-card--mobile;
		}
	}

	.cdx-card__thumbnail {
		// Provide a subtle background color, in case there is any text box expanding glitch.
		background-color: @background-color-neutral-subtle;
		min-width: @size-800;
		width: @size-800;
		min-height: @size-800;
		margin-right: 0;

		// Apply necessary specificity to set thumbnail size.
		&.cdx-thumbnail .cdx-thumbnail__image {
			// Center vertically and top align thumbnail image.
			background-position: center 0;
			width: @size-full;
			height: @size-full;
			aspect-ratio: 1;
			// Remove Codex default border on thumbnails. Rely on background color of thumbnail
			// container instead.
			border-width: 0;
		}
	}

	.cdx-card__text {
		// Let text container take all remaining space.
		flex: 1 1 auto;
		box-sizing: @box-sizing-base;
		height: @size-full;
		padding: @spacing-50 @spacing-75;
	}

	.cdx-card__text__title,
	.cdx-card__text__description {
		// Contradictory to its name, non standards conforming `-webkit-box` value is supported
		// across all major browsers.
		// Must be used in combination with `-webkit-box-orient` to make `-webkit-line-clamp`
		// below work.
		display: -webkit-box;
		-webkit-box-orient: vertical;
		// Contain text to a given amount of lines when used in combination with
		// `display: -webkit-box` and ` `-webkit-box-orient`. It will end with ellipsis when
		// `text-overflow: ellipsis` is included.
		-webkit-line-clamp: 2;
		text-overflow: ellipsis;
		overflow: hidden;
	}

	.cdx-card__text__title {
		font-family: @font-family-serif;
		font-size: @font-size-x-large;
		font-weight: @font-weight-normal;
		line-height: @line-height-x-large;
	}

	.cdx-card__text__description {
		color: @color-subtle;
		font-size: @font-size-small;
		line-height: @line-height-small;
	}

	.cdx-card__text__supporting-text {
		color: @color-subtle;
		font-size: @font-size-x-small;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
	}

	// "Show more" button.
	+ .cdx-button {
		display: block;
		margin-top: @spacing-200;
		margin-left: auto;
		margin-right: auto;
	}
}

.reading-lists-empty {
	max-width: @size-2400;
	margin-left: auto;
	margin-right: auto;
	text-align: center;
}

// An `<h2>` element, for semantic structure, but styled differently from Vector.
.reading-lists-empty__title {
	margin-top: @spacing-300;
	margin-bottom: 0;
	padding: 0;
	border: 0;
	font-family: @font-family-base;
	font-size: @font-size-medium;
	font-weight: @font-weight-bold;

	&::before {
		display: block;
		content: url( ../assets/list-empty-state.svg );
		margin: 0 auto;
	}
}

.reading-lists-empty__description {
	margin-top: @spacing-100;
}

.reading-lists-play-store,
.reading-lists-app-store {
	display: inline-block;
	background-image: url( ../assets/sprite.svg );
	background-repeat: no-repeat;
}

.reading-lists-play-store {
	background-position: 0 -591px;
	width: 124px;
	height: 38px;
}

.reading-lists-app-store {
	background-position: 0 -629px;
	width: 110px;
	height: 38px;
}

.reading-lists-anonymized-previews .reading-lists-container > * {
	/* stylelint-disable-next-line declaration-no-important */
	display: none !important;
}
